#!/bin/bash

if [ "$1" == "" ]; then
    echo "Informe IP: 192.168.0";
else
    for END_OF_IP in {1..254}; do
        knock -d 500 -v $1.$END_OF_IP 13 37 30000 3000;

        sleep 5;
        RESULT=$(curl -i --silent $1.$END_OF_IP:1337 | grep "HTTP/1.1")

        if [[ "$RESULT" == *" 200 "* ]]; then
            echo "Checking PortNock on IP: $1.$END_OF_IP ...";
            echo "Malware located! ==> HEADER $RESULT";
        fi;
    done;
fi;